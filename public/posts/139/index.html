<!DOCTYPE html>






























<html
  class="not-ready text-sm lg:text-base"
  style="--bg: "
  lang="en"
>
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />

  
  <title>如何使用 JavaScript 阻止屏幕进入睡眠状态 - 灏天阁</title>

  
  <meta name="theme-color" />
  
  <meta name="description" content="前言 在移动设备上，屏幕常亮是一个常见的需求，尤其是在使用 Web 应用时。为了满足这一需求，开发者可以使用 JavaScript 中的 Wake Lock API 来阻止屏幕进入睡眠状态。本文将详细介绍如何使用这一 API，并讨论其在不同浏览器上的兼容性情况。
检查 Wake Lock 功能的支持情况 在使用 Wake Lock API 之前，我们需要确认当前浏览器是否支持这一功能。可以通过以下代码进行检查：
const isWakeLockSupported = &#34;wakeLock&#34; in navigator; 如果 isWakeLockSupported 为 true，则表示当前浏览器支持 Wake Lock 功能。
浏览器兼容性 Wake Lock API 的兼容性因浏览器和操作系统而异。截至目前，以下是主流浏览器对 Wake Lock API 的支持情况：
Chrome: 从 Chrome 85 版本开始支持 Wake Lock API。
Firefox: 支持 Wake Lock API，但可能需要在设置中启用相应的功能。
Safari: 截至目前，Safari 尚未支持 Wake Lock API。不过，可以使用第三方库如 NoSleep.js 作为替代方案。
Edge: 作为基于 Chromium 的浏览器，Edge 的兼容性与 Chrome 类似。" />
  <meta name="author" content="" />
  

  
  
  
  
  
  
  <link rel="preload stylesheet" as="style" href="/main.min.css" />

  

  
  
  
    
  
  <link
    rel="preload"
    as="image"
    href="/theme.png"
  />

  
  
  
  <link rel="preload" as="image" href="/imgs/logo.png" />
  
  

  

  
  <link rel="icon" href="/img/ico.ico" />
  <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
  
  <meta name="generator" content="Hugo 0.108.0">

  
  

  
  
  
  
  
  
  
  
  
  <meta property="og:title" content="如何使用 JavaScript 阻止屏幕进入睡眠状态" />
<meta property="og:description" content="前言 在移动设备上，屏幕常亮是一个常见的需求，尤其是在使用 Web 应用时。为了满足这一需求，开发者可以使用 JavaScript 中的 Wake Lock API 来阻止屏幕进入睡眠状态。本文将详细介绍如何使用这一 API，并讨论其在不同浏览器上的兼容性情况。
检查 Wake Lock 功能的支持情况 在使用 Wake Lock API 之前，我们需要确认当前浏览器是否支持这一功能。可以通过以下代码进行检查：
const isWakeLockSupported = &#34;wakeLock&#34; in navigator; 如果 isWakeLockSupported 为 true，则表示当前浏览器支持 Wake Lock 功能。
浏览器兼容性 Wake Lock API 的兼容性因浏览器和操作系统而异。截至目前，以下是主流浏览器对 Wake Lock API 的支持情况：
Chrome: 从 Chrome 85 版本开始支持 Wake Lock API。
Firefox: 支持 Wake Lock API，但可能需要在设置中启用相应的功能。
Safari: 截至目前，Safari 尚未支持 Wake Lock API。不过，可以使用第三方库如 NoSleep.js 作为替代方案。
Edge: 作为基于 Chromium 的浏览器，Edge 的兼容性与 Chrome 类似。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/139/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-04-07T22:11:15+08:00" />
<meta property="article:modified_time" content="2024-04-07T22:11:15+08:00" />

  
  <meta itemprop="name" content="如何使用 JavaScript 阻止屏幕进入睡眠状态">
<meta itemprop="description" content="前言 在移动设备上，屏幕常亮是一个常见的需求，尤其是在使用 Web 应用时。为了满足这一需求，开发者可以使用 JavaScript 中的 Wake Lock API 来阻止屏幕进入睡眠状态。本文将详细介绍如何使用这一 API，并讨论其在不同浏览器上的兼容性情况。
检查 Wake Lock 功能的支持情况 在使用 Wake Lock API 之前，我们需要确认当前浏览器是否支持这一功能。可以通过以下代码进行检查：
const isWakeLockSupported = &#34;wakeLock&#34; in navigator; 如果 isWakeLockSupported 为 true，则表示当前浏览器支持 Wake Lock 功能。
浏览器兼容性 Wake Lock API 的兼容性因浏览器和操作系统而异。截至目前，以下是主流浏览器对 Wake Lock API 的支持情况：
Chrome: 从 Chrome 85 版本开始支持 Wake Lock API。
Firefox: 支持 Wake Lock API，但可能需要在设置中启用相应的功能。
Safari: 截至目前，Safari 尚未支持 Wake Lock API。不过，可以使用第三方库如 NoSleep.js 作为替代方案。
Edge: 作为基于 Chromium 的浏览器，Edge 的兼容性与 Chrome 类似。"><meta itemprop="datePublished" content="2024-04-07T22:11:15+08:00" />
<meta itemprop="dateModified" content="2024-04-07T22:11:15+08:00" />
<meta itemprop="wordCount" content="167">
<meta itemprop="keywords" content="" />
  
  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="如何使用 JavaScript 阻止屏幕进入睡眠状态"/>
<meta name="twitter:description" content="前言 在移动设备上，屏幕常亮是一个常见的需求，尤其是在使用 Web 应用时。为了满足这一需求，开发者可以使用 JavaScript 中的 Wake Lock API 来阻止屏幕进入睡眠状态。本文将详细介绍如何使用这一 API，并讨论其在不同浏览器上的兼容性情况。
检查 Wake Lock 功能的支持情况 在使用 Wake Lock API 之前，我们需要确认当前浏览器是否支持这一功能。可以通过以下代码进行检查：
const isWakeLockSupported = &#34;wakeLock&#34; in navigator; 如果 isWakeLockSupported 为 true，则表示当前浏览器支持 Wake Lock 功能。
浏览器兼容性 Wake Lock API 的兼容性因浏览器和操作系统而异。截至目前，以下是主流浏览器对 Wake Lock API 的支持情况：
Chrome: 从 Chrome 85 版本开始支持 Wake Lock API。
Firefox: 支持 Wake Lock API，但可能需要在设置中启用相应的功能。
Safari: 截至目前，Safari 尚未支持 Wake Lock API。不过，可以使用第三方库如 NoSleep.js 作为替代方案。
Edge: 作为基于 Chromium 的浏览器，Edge 的兼容性与 Chrome 类似。"/>

  
  
</head>
  <body class="text-black duration-200 ease-out dark:text-white">
    
    

    
    <main
      class="prose prose-neutral relative mx-auto min-h-[calc(100%-10rem)] max-w-3xl px-8 pt-20 dark:prose-invert"
      id="main"
    >
      

<article>
  <header class="mb-10">
    <h1 class="!my-0 pb-2.5">
      如何使用 JavaScript 阻止屏幕进入睡眠状态
    </h1>

    
    <div class="text-sm opacity-60">
      
      <time>Apr 7, 2024</time>
      
      
      <span class="mx-1">&middot;</span>
      <span>Yin灏</span>
    </div>
    
  </header>

  <section><h2 id="前言">前言</h2>
<p>在移动设备上，屏幕常亮是一个常见的需求，尤其是在使用 Web 应用时。为了满足这一需求，开发者可以使用 JavaScript 中的 Wake Lock API 来阻止屏幕进入睡眠状态。本文将详细介绍如何使用这一 API，并讨论其在不同浏览器上的兼容性情况。</p>
<h2 id="检查-wake-lock-功能的支持情况">检查 Wake Lock 功能的支持情况</h2>
<p>在使用 Wake Lock API 之前，我们需要确认当前浏览器是否支持这一功能。可以通过以下代码进行检查：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">isWakeLockSupported</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;wakeLock&#34;</span> <span style="color:#66d9ef">in</span> <span style="color:#a6e22e">navigator</span>;
</span></span></code></pre></div><p>如果 isWakeLockSupported 为 true，则表示当前浏览器支持 Wake Lock 功能。</p>
<h2 id="浏览器兼容性">浏览器兼容性</h2>
<p>Wake Lock API 的兼容性因浏览器和操作系统而异。截至目前，以下是主流浏览器对 Wake Lock API 的支持情况：</p>
<ul>
<li>
<p>Chrome: 从 Chrome 85 版本开始支持 Wake Lock API。</p>
</li>
<li>
<p>Firefox: 支持 Wake Lock API，但可能需要在设置中启用相应的功能。</p>
</li>
<li>
<p>Safari: 截至目前，Safari 尚未支持 Wake Lock API。不过，可以使用第三方库如 NoSleep.js 作为替代方案。</p>
</li>
<li>
<p>Edge: 作为基于 Chromium 的浏览器，Edge 的兼容性与 Chrome 类似。</p>
</li>
<li>
<p>Opera: 同样基于 Chromium，支持情况与 Chrome 相似。</p>
</li>
</ul>
<h2 id="请求屏幕保持唤醒状态">请求屏幕保持唤醒状态</h2>
<p>要请求屏幕保持唤醒状态，可以使用 navigator.wakeLock.request 方法。这个方法是基于 Promise 的，因此需要在异步函数中调用。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">let</span> <span style="color:#a6e22e">wakeLock</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">requestScreenWakeLock</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">async</span> () =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">wakeLock</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">navigator</span>.<span style="color:#a6e22e">wakeLock</span>.<span style="color:#a6e22e">request</span>(<span style="color:#e6db74">&#34;screen&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;屏幕保持唤醒状态成功！&#34;</span>);
</span></span><span style="display:flex;"><span>  } <span style="color:#66d9ef">catch</span> (<span style="color:#a6e22e">err</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">error</span>(<span style="color:#e6db74">`错误：</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">err</span>.<span style="color:#a6e22e">name</span><span style="color:#e6db74">}</span><span style="color:#e6db74">, 消息：</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">err</span>.<span style="color:#a6e22e">message</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">requestScreenWakeLock</span>();
</span></span></code></pre></div><h2 id="释放屏幕唤醒锁">释放屏幕唤醒锁</h2>
<p>当不再需要保持屏幕唤醒状态时，应该释放唤醒锁。可以使用 wakeLock.release 方法来实现：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">wakeLock</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">wakeLock</span>.<span style="color:#a6e22e">release</span>().<span style="color:#a6e22e">then</span>(() =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">wakeLock</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;屏幕唤醒锁已释放&#34;</span>);
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="监听唤醒锁的释放">监听唤醒锁的释放</h2>
<p>如果因为某些原因（如用户切换到其他窗口或标签页）导致唤醒锁被释放，可以通过添加事件监听器来监听这一事件：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">wakeLock</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">wakeLock</span>.<span style="color:#a6e22e">addEventListener</span>(<span style="color:#e6db74">&#34;release&#34;</span>, () =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;屏幕唤醒锁已被释放&#34;</span>);
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="根据文档可见性重新获取唤醒锁">根据文档可见性重新获取唤醒锁</h2>
<p>在某些情况下，当文档的可见性发生变化时（例如用户切换回当前标签页），可能需要重新获取唤醒锁。可以通过监听 visibilitychange 事件来实现：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span>document.<span style="color:#a6e22e">addEventListener</span>(<span style="color:#e6db74">&#34;visibilitychange&#34;</span>, <span style="color:#66d9ef">async</span> () =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (document.<span style="color:#a6e22e">visibilityState</span> <span style="color:#f92672">===</span> <span style="color:#e6db74">&#34;visible&#34;</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#f92672">!</span><span style="color:#a6e22e">wakeLock</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">requestScreenWakeLock</span>();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>});
</span></span></code></pre></div><h2 id="结论">结论</h2>
<p>通过以上步骤，开发者可以使用 JavaScript 中的 Wake Lock API 来保持屏幕常亮，从而提升用户体验。需要注意的是，这一 API 在不同的浏览器和平台上的支持情况可能不同，因此在实际使用时需要进行充分的测试和兼容性处理。同时，开发者应当注意合理使用这一 API，避免对用户的设备电池寿命造成不必要的影响。</p>
</section>

  
  

  
  
  
  <nav class="mt-24 flex rounded-lg bg-black/[3%] text-lg dark:bg-white/[8%]">
    
    
    <a
      class="ml-auto flex w-1/2 items-center justify-end p-6 pl-3 no-underline"
      href="/posts/138/"
      ><span>提升JavaScript代码质量的最佳实践</span><span class="ml-1.5">→</span></a
    >
    
  </nav>
  

  
  
</article>


    </main>

    <footer
  class="opaco mx-auto flex h-[5rem] max-w-3xl items-center px-8 text-[0.9em] opacity-60"
  style="position: relative; z-index: 10;display: none;"
>
  <div class="mr-auto">
    &copy; 2024
    <a class="link" href="/">灏天阁</a>
  </div>
  <a class="link" href="https://yinchuanbo.github.io/" rel="noopener" target="_blank"
    >Powered by YinHao</a
  >️ ▷
</footer>


    <div class="img__mask" style="display: none;">
      <img src="" alt="">
      <span class="close_btn"></span>
    </div>

    <script>
      const imgs = document.images;
      const imgMask = document.querySelector('.img__mask')
      const closeBtn = document.querySelector('.close_btn')
      for (let i = 0; i < imgs.length; i++) {
        const element = imgs[i];
        element.onclick = () => {
          const src = element.src;
          imgMask.style.display = 'flex';
          imgMask.querySelector('img').src = src;
        }
      }
      closeBtn.onclick = () => {
        imgMask.style.display = 'none';
      }
    </script>
  </body>
</html>
